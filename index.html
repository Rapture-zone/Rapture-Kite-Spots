<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="css/leaflet.css">
    <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
    <link rel="stylesheet" href="css/L.Control.Locate.min.css">
    <link rel="stylesheet" href="css/qgis2web.css">
    <link rel="stylesheet" href="css/fontawesome-all.min.css">
    <link rel="stylesheet" href="css/leaflet.photon.css">
    <style>
      html, body, #map { width: 100%; height: 100%; padding: 0; margin: 0; }
      .label-state {
        color:#323232; font-size:10pt; font-family:'Open Sans', sans-serif;
        text-shadow:0 0 2px rgba(255,255,255,.85); pointer-events:none;
      }
      .leaflet-interactive { cursor: pointer; }
    </style>
    <title></title>
  </head>
  <body>
    <div id="map"></div>

    <!-- libs from your export -->
    <script src="js/qgis2web_expressions.js"></script>
    <script src="js/leaflet.js"></script>
    <script src="js/L.Control.Layers.Tree.min.js"></script>
    <script src="js/L.Control.Locate.min.js"></script>
    <script src="js/leaflet.rotatedMarker.js"></script>
    <script src="js/leaflet.pattern.js"></script>
    <script src="js/leaflet-hash.js"></script>
    <script src="js/Autolinker.min.js"></script>
    <script src="js/rbush.min.js"></script>
    <script src="js/labelgun.min.js"></script>
    <script src="js/labels.js"></script>
    <script src="js/leaflet.photon.js"></script>

    <!-- your data -->
    <script src="data/SouthAustralia_1.js"></script>
    <script src="data/Victoria_2.js"></script>
    <script src="data/WesternAustralia_3.js"></script>

    <script>
      // --- Map + sane AU bounds ---
      var map = L.map('map', { zoomControl:false, maxZoom:13, minZoom:3 });
      var AU_BOUNDS = L.latLngBounds([[-44,112],[-10,154]]);
      map.fitBounds(AU_BOUNDS);
      map.setMaxBounds(AU_BOUNDS.pad(0.15));

      var hash = new L.Hash(map);
      map.attributionControl.setPrefix('<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>');

      var autolinker = new Autolinker({ truncate: { length: 36, location: 'smart' } });

      // --- Normalise link values from Link_HTML ---
      function normalizeLink(raw) {
        if (!raw) return '';
        var href = String(raw).trim();

        // If Link_HTML is a full <a ...> chunk, extract the href
        if (href.indexOf('<a') !== -1) {
          var div = document.createElement('div');
          div.innerHTML = href;
          var a = div.querySelector('a');
          if (a && a.getAttribute('href')) href = a.getAttribute('href');
        }

        // Already web url?
        if (/^https?:\/\//i.test(href)) return href;

        // Handle file:/// and Windows paths -> slug
        if (href.slice(0,7).toLowerCase() === 'file://') href = hr
